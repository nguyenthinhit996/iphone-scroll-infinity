<html lang="en" class="">

<head>
  <meta charset="UTF-8" />
  <title>Infinite Scroll - Unsplash API Demo (Fixed)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />


  <style id="INLINE_PEN_STYLESHEET_ID">
    body {
      font-family: sans-serif;
      line-height: 1.4;
      padding: 20px;
      max-width: 640px;
      margin: 0 auto;
    }

    .photo-item {
      margin: 40px 0;
      padding-top: 20px;
      border-top: 1px solid #DDD;
    }

    .photo-item__image {
      display: block;
      max-width: 100%;
    }

    .page-load-status {
      display: none;
      /* hidden by default */
      padding-top: 20px;
      border-top: 1px solid #DDD;
      text-align: center;
      color: #777;
    }

    /* loader ellips in separate pen CSS */
  </style>



</head>

<body>
  <h1>Infinite Scroll - Loading JSON</h1>

  <p>Loading photos from the <a
      href="https://unsplash.com/developers?utm_source=infinite-scroll-demos&amp;utm_medium=referral&amp;utm_campaign=api-credit">Unsplash
      API</a></p>

  <div class="container">

  </div>

  <div class="page-load-status">
    <div class="loader-ellips infinite-scroll-request">
      <span class="loader-ellips__dot"></span>
      <span class="loader-ellips__dot"></span>
      <span class="loader-ellips__dot"></span>
      <span class="loader-ellips__dot"></span>
    </div>
    <p class="infinite-scroll-last">End of content</p>
    <p class="infinite-scroll-error">No more pages to load</p>
  </div>


  <!-- .photo-item template HTML -->
  <script type="text/html" id="photo-item-template">
  <div class="photo-item">
    <img class="photo-item__image" src="{{urls.regular}}" alt="Photo by {{user.name}}" />
    <p class="photo-item__caption">
      <a href="{{user.links.html}}?utm_source=infinite-scroll-demos&utm_medium=referral&utm_campaign=api-credit">{{user.name}}</a>
    </p>
  </div>
</script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <script src="https://unpkg.com/infinite-scroll@3/dist/infinite-scroll.pkgd.js"></script>

  <script>


    // Get an API key for your demos at https://unsplash.com/developers
    var unsplashID = '9ad80b14098bcead9c7de952435e937cc3723ae61084ba8e729adb642daf0251';

    var $container = $('.container').infiniteScroll({
      path: function () {
        return 'https://api.unsplash.com/photos?client_id='
          + unsplashID + '&page=' + this.pageIndex;
      },
      // load response as flat text
      responseType: 'text',
      status: '.scroll-status',
      history: false,
    });

    $container.on('load.infiniteScroll', function (event, response) {
      console.log("response thinh", response)
      // parse response into JSON data
      var data = JSON.parse(response);
      // compile data into HTML
      var itemsHTML = data.map(getItemHTML).join('');
      // convert HTML string into elements
      var $items = $(itemsHTML);
      // append item elements
      $container.infiniteScroll('appendItems', $items);
    });

    // load initial page
    $container.infiniteScroll('loadNextPage');

    //------------------//

    var itemTemplateSrc = $('#photo-item-template').html();

    function getItemHTML(photo) {
      return microTemplate(itemTemplateSrc, photo);
    }

    // micro templating, sort-of
    function microTemplate(src, data) {
      // replace {{tags}} in source
      return src.replace(/\{\{([\w\-_\.]+)\}\}/gi, function (match, key) {
        // walk through objects to get value
        var value = data;
        key.split('.').forEach(function (part) {
          value = value[part];
        });
        return value;
      });
    }

  </script>

</body>

</html>